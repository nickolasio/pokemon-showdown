// Generated by CoffeeScript 1.10.0
(function() {
  var PokeClient, expect;

  expect = require('chai').expect;

  PokeClient = require('../src').PokeClient;

  describe('PokeClient', function() {
    it('should be tested');
    return it('can connect and challenge others', function(done) {
      var alice, bob;
      this.timeout(5 * 1000);
      alice = new PokeClient();
      alice.connect();
      alice.on('ready', function() {
        return alice.login('alice-the-pscbot');
      });
      alice.on('login', function() {
        return alice.send('/join lobby');
      });
      bob = new PokeClient();
      bob.connect();
      bob.on('ready', function() {
        return bob.login('bob-the-pscbot');
      });
      bob.on('login', function() {
        return bob.send('/join lobby');
      });
      alice.on('challenge', function(challenges) {
        expect(challenges).to.have.property('challengeTo', null);
        expect(challenges).to.have.deep.property('challengesFrom.bobthepscbot', 'randombattle');
        return done();
      });
      return bob.on('internal:message', function(message) {
        if (message.type === PokeClient.MESSAGE_TYPES.ROOM_INIT.INIT) {
          return bob.challenge('alice-the-pscbot', {
            format: 'randombattle'
          });
        }
      });
    });
  });

}).call(this);
